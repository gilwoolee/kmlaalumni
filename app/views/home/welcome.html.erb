<!-- WELCOME_CONTAINER -->
<div id="welcome_container">
	
	<!-- BANNER -->
	<div id="welcome_banner">
		<img src="/assets/welcome_banner.png" alt="민족사관고등학교 동문회에 오신 것을 환영합니다"/>
	</div>
	
	<!-- FORM_CONTAINER -->
	<div id="form_container">
		
		<!-- SIGNIN_FORM -->
		<div id="signin_form">
			<%= form_for(resource, url: session_path(resource_name), html: {id:'signin_form'}) do |f| %>
				
				<ul>
					<li><%= f.text_field :email, placeholder: "이메일", autocomplete: :off %></li>
					<li><%= f.password_field :password, placeholder: "비밀번호", autocomplete: :off %></li>
				</ul>
				
				<% if devise_mapping.rememberable? -%>
					<div><%= f.check_box :remember_me %> 로그인 상태 유지</div>
				<% end -%>
				
				<div><%= f.submit "로그인" %></div>
				
			<% end %>
		</div>
		
		<!-- SIGNUP_FORM -->
		<div id="signup_form_container">
		
			<div id="signup_message">
				<img src="/assets/welcome_signup_message.png" alt="처음 뵙네요. 반갑습니다!"/>
			</div>
			
			<%= form_for(resource, url: registration_path(resource_name), html: {id:'signup_form'} ) do |f| %>
				<div id="message"></div>
                <ul id="signup_form_authenticate_alumni_section">
                  <li><%= f.text_field :name, placeholder: "이름", autocomplete: :off %></li>
                  <li><%= f.text_field :student_number, placeholder: "학번", autocomplete: :off %></li>
				</ul>
				
                <div id="verify_alumni_link_container"><%= link_to "동문 인증", verify_alumni_url, id: 'verify_alumni_link' %></div>
                
                <ul id="signup_form_new_user_info_section", style="display:none;">
                  <li><%= f.text_field :email, placeholder: "이메일", autocomplete: :off %></li>
				  <li><%= f.password_field :password, placeholder: "비밀번호", autocomplete: :off %></li>
                </ul>
                
				<div id="signup_form_submit", style="display:none;"><%= f.submit "Sign up" %></div>
			<% end %>
		</div>
	</div>
</div>

<script text="javascript">
  $(document).ready( function() {
    $('#verify_alumni_link').click( function(event) {
      event.preventDefault();
      $.ajax({
        url: this.href + "?" + $('#signup_form').serialize(),
        type: 'get',
        dataType: 'json',
        success: function(data) {
          if (data.status) {
            $('#message').html(data.wave + "기 " + data.name + " 동문님 환영합니다!");
            $('#signup_form_authenticate_alumni_section').hide();
            $('#verify_alumni_link_container').hide();
            $('#signup_form_new_user_info_section').show();
            $('#signup_form_submit').show();
          } else {
            $('#message').html("동문 인증에 실패했습니다. 다시 한 번 이름과 학번을 입력해주세요");
            $('#signup_form_authenticate_alumni_section').show();
            $('#verify_alumni_link_container').show();
            $('#signup_form_new_user_info_section').hide();
            $('#signup_form_submit').hide();
          }
        }
      });
    });
  });
</script>
